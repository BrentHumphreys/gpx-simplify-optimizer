function hideFormats(){$("#download-formats").hide(),$("#view-formats").hide()}function chooseDownloadFormat(){$("#download-formats").show(),$("#view-formats").hide()}function chooseViewFormat(){$("#view-formats").show(),$("#download-formats").hide()}function GeoJSONFormat(){this.param={key:"geojson",name:"GeoJSON",extension:"json",contenttype:"appplication/json"},this.exportData=function(a){return JSON.stringify(a)}}function GPXFormat(){this.param={key:"gpx",name:"GPX",extension:"gpx",contenttype:"text/xml"},this.exportData=function(a){return togpx(a)}}function PathFormat(){this.param={key:"path",name:"Path",extension:"txt",contenttype:"text/plain"},this.exportData=function(a){return geojsonToPath(a)}}$("#export-close").on("click",function(){$("#export-format").hide()});var Format=function(){this.param={key:"format",name:"RootFormat"},this.formats=["GeoJSONFormat","GPXFormat","PathFormat"]};Format.prototype={loadAll:function(data){var f;this.formats.forEach(function(formatName){eval("f = new "+formatName+"();"),f.load()})},load:function(){var a=document.createElement("a"),b=document.createTextNode("View in "+this.param.name);a.appendChild(b),a.title="View the simplified data in "+this.param.name,a.className="view",$(a).on("click",this.viewClick.bind(this)),$("#view-formats").append(a);var a=document.createElement("a"),b=document.createTextNode("Download in "+this.param.name);a.appendChild(b),a.title="Download the simplified data in "+this.param.name,a.className="download",$(a).on("click",this.saveClick.bind(this)),$("#download-formats").append(a)},save:function(a,b,c){b=b.replace(/\..*/,""),b=b+"_"+c+"nodes."+this.param.extension;var d=this.exportData(a);try{if(new Blob){var e=new Blob([d],{type:this.param.contenttype+";charset=utf-8"});saveAs(e,b)}}catch(f){return alert("Please upload GPX/GeoJSON/KML file first, using Chrome or Firefox :"+f.message),console.log(f.message),!1}hideFormats()},saveClick:function(){this.save(window.simplifyLayerData,window.simplifyLayerName,window.simplifyNodes)},view:function(a){var b=this.exportData(a);try{new Blob&&($("#export-content").val(b),$("#export-format").show())}catch(c){return alert("Please upload GPX/GeoJSON/KML file first, using Chrome or Firefox :"+c.message),console.log(c.message),!1}hideFormats()},viewClick:function(){this.view(window.simplifyLayerData)}},GeoJSONFormat.prototype=new Format,GPXFormat.prototype=new Format,PathFormat.prototype=new Format;