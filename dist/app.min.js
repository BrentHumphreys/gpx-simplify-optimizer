!function(a){"function"==typeof define&&define.amd?define(["jquery"],a):a("object"==typeof exports?require("jquery"):jQuery)}(function(a){function b(a){return h.raw?a:encodeURIComponent(a)}function c(a){return h.raw?a:decodeURIComponent(a)}function d(a){return b(h.json?JSON.stringify(a):String(a))}function e(a){0===a.indexOf('"')&&(a=a.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\"));try{return a=decodeURIComponent(a.replace(g," ")),h.json?JSON.parse(a):a}catch(b){}}function f(b,c){var d=h.raw?b:e(b);return a.isFunction(c)?c(d):d}var g=/\+/g,h=a.cookie=function(e,g,i){if(void 0!==g&&!a.isFunction(g)){if(i=a.extend({},h.defaults,i),"number"==typeof i.expires){var j=i.expires,k=i.expires=new Date;k.setTime(+k+864e5*j)}return document.cookie=[b(e),"=",d(g),i.expires?"; expires="+i.expires.toUTCString():"",i.path?"; path="+i.path:"",i.domain?"; domain="+i.domain:"",i.secure?"; secure":""].join("")}for(var l=e?void 0:{},m=document.cookie?document.cookie.split("; "):[],n=0,o=m.length;o>n;n++){var p=m[n].split("="),q=c(p.shift()),r=p.join("=");if(e&&e===q){l=f(r,g);break}e||void 0===(r=f(r))||(l[q]=r)}return l};h.defaults={},a.removeCookie=function(b,c){return void 0===a.cookie(b)?!1:(a.cookie(b,"",a.extend({},c,{expires:-1})),!a.cookie(b))}});;
L.Control.Sidebar=L.Control.extend({includes:L.Mixin.Events,options:{closeButton:!0,position:"left",autoPan:!0},initialize:function(a,b){L.setOptions(this,b);var c=this._contentContainer=L.DomUtil.get(a);c.parentNode.removeChild(c);var d="leaflet-",e=this._container=L.DomUtil.create("div",d+"sidebar "+this.options.position);if(L.DomUtil.addClass(c,d+"control"),e.appendChild(c),this.options.closeButton){var f=this._closeButton=L.DomUtil.create("a","close",e);f.innerHTML="&times;"}},addTo:function(a){var b=this._container,c=this._contentContainer;if(this.options.closeButton){var d=this._closeButton;L.DomEvent.on(d,"click",this.hide,this)}L.DomEvent.on(b,"transitionend",this._handleTransitionEvent,this).on(b,"webkitTransitionEnd",this._handleTransitionEvent,this);var e=a._controlContainer;e.insertBefore(b,e.firstChild),this._map=a;var f=L.DomEvent.stopPropagation;return L.DomEvent.on(c,"click",f).on(c,"mousedown",f).on(c,"touchstart",f).on(c,"dblclick",f).on(c,"mousewheel",f).on(c,"MozMousePixelScroll",f),this},removeFrom:function(a){this.hide();var b=this._contentContainer,c=a._controlContainer;c.removeChild(this._container),this._map=null;var d=L.DomEvent.stopPropagation;if(L.DomEvent.off(b,"click",d).off(b,"mousedown",d).off(b,"touchstart",d).off(b,"dblclick",d).off(b,"mousewheel",d).off(b,"MozMousePixelScroll",d),L.DomEvent.off(container,"transitionend",this._handleTransitionEvent,this).off(container,"webkitTransitionEnd",this._handleTransitionEvent,this),this._closeButton&&this._close){var e=this._closeButton;L.DomEvent.off(e,"click",this.hide,this)}return this},isVisible:function(){return L.DomUtil.hasClass(this._container,"visible")},show:function(){this.isVisible()||(L.DomUtil.addClass(this._container,"visible"),this.options.autoPan&&this._map.panBy([-this.getOffset()/2,0],{duration:.5}),this.fire("show"))},hide:function(a){this.isVisible()&&(L.DomUtil.removeClass(this._container,"visible"),this.options.autoPan&&this._map.panBy([this.getOffset()/2,0],{duration:.5}),this.fire("hide")),a&&L.DomEvent.stopPropagation(a)},toggle:function(){this.isVisible()?this.hide():this.show()},getContainer:function(){return this._contentContainer},getCloseButton:function(){return this._closeButton},setContent:function(a){return this.getContainer().innerHTML=a,this},getOffset:function(){return"right"===this.options.position?-this._container.offsetWidth:this._container.offsetWidth},_handleTransitionEvent:function(a){("left"==a.propertyName||"right"==a.propertyName)&&this.fire(this.isVisible()?"shown":"hidden")}}),L.control.sidebar=function(a,b){return new L.Control.Sidebar(a,b)};;
toGeoJSON=function(){"use strict";function a(a){if(!a||!a.length)return 0;for(var b=0,c=0;b<a.length;b++)c=(c<<5)-c+a.charCodeAt(b)|0;return c}function b(a,b){return a.getElementsByTagName(b)}function c(a,b){return a.getAttribute(b)}function d(a,b){return parseFloat(c(a,b))}function e(a,c){var d=b(a,c);return d.length?d[0]:null}function f(a){return a.normalize&&a.normalize(),a}function g(a){for(var b=0,c=[];b<a.length;b++)c[b]=parseFloat(a[b]);return c}function h(a){var b={};for(var c in a)a[c]&&(b[c]=a[c]);return b}function i(a){return a&&f(a),a&&a.firstChild&&a.firstChild.nodeValue||""}function j(a){return g(a.replace(p,"").split(","))}function k(a){for(var b=a.replace(q,"").split(r),c=[],d=0;d<b.length;d++)c.push(j(b[d]));return c}function l(a){var b=[d(a,"lon"),d(a,"lat")],c=e(a,"ele");return c&&b.push(parseFloat(i(c))),b}function m(){return{type:"FeatureCollection",features:[]}}function n(a){return o.serializeToString(a)}var o,p=/\s*/g,q=/^\s*|\s*$/g,r=/\s+/;"undefined"!=typeof XMLSerializer?o=new XMLSerializer:"object"!=typeof exports||"object"!=typeof process||process.browser||(o=new(require("xmldom").XMLSerializer));var s={kml:function(d,f){function h(a){var b,c;return a=a||"","#"===a.substr(0,1)&&(a=a.substr(1)),(6===a.length||3===a.length)&&(b=a),8===a.length&&(c=parseInt(a.substr(0,2),16)/255,b=a.substr(2)),[b,isNaN(c)?void 0:c]}function l(a){return g(a.split(" "))}function o(a){for(var c=b(a,"coord","gx"),d=[],e=0;e<c.length;e++)d.push(l(i(c[e])));return d}function p(a){var c,d,f,g,h,l=[];if(e(a,"MultiGeometry"))return p(e(a,"MultiGeometry"));if(e(a,"MultiTrack"))return p(e(a,"MultiTrack"));for(f=0;f<t.length;f++)if(d=b(a,t[f]))for(g=0;g<d.length;g++)if(c=d[g],"Point"==t[f])l.push({type:"Point",coordinates:j(i(e(c,"coordinates")))});else if("LineString"==t[f])l.push({type:"LineString",coordinates:k(i(e(c,"coordinates")))});else if("Polygon"==t[f]){var m=b(c,"LinearRing"),n=[];for(h=0;h<m.length;h++)n.push(k(i(e(m[h],"coordinates"))));l.push({type:"Polygon",coordinates:n})}else"Track"==t[f]&&l.push({type:"LineString",coordinates:o(c)});return l}function q(a){var c,d=p(a),f={},g=i(e(a,"name")),j=i(e(a,"styleUrl")),k=i(e(a,"description")),l=e(a,"TimeSpan"),m=e(a,"ExtendedData"),n=e(a,"LineStyle"),o=e(a,"PolyStyle");if(!d.length)return[];if(g&&(f.name=g),j&&s[j]&&(f.styleUrl=j,f.styleHash=s[j]),k&&(f.description=k),l){var q=i(e(l,"begin")),r=i(e(l,"end"));f.timespan={begin:q,end:r}}if(n){var t=h(i(e(n,"color"))),u=t[0],v=t[1],w=parseFloat(i(e(n,"width")));u&&(f.stroke=u),isNaN(v)||(f["stroke-opacity"]=v),isNaN(w)||(f["stroke-width"]=w)}if(o){var x=h(i(e(o,"color"))),y=x[0],z=x[1],A=i(e(o,"fill")),B=i(e(o,"outline"));y&&(f.fill=y),isNaN(z)||(f["fill-opacity"]=z),A&&(f["fill-opacity"]="1"===A?1:0),B&&(f["stroke-opacity"]="1"===B?1:0)}if(m){var C=b(m,"Data"),D=b(m,"SimpleData");for(c=0;c<C.length;c++)f[C[c].getAttribute("name")]=i(e(C[c],"value"));for(c=0;c<D.length;c++)f[D[c].getAttribute("name")]=i(D[c])}return[{type:"Feature",geometry:1===d.length?d[0]:{type:"GeometryCollection",geometries:d},properties:f}]}f=f||{};for(var r=m(),s={},t=["Polygon","LineString","Point","Track"],u=b(d,"Placemark"),v=b(d,"Style"),w=0;w<v.length;w++)s["#"+c(v[w],"id")]=a(n(v[w])).toString(16);for(var x=0;x<u.length;x++)r.features=r.features.concat(q(u[x]));return r},gpx:function(a){function c(a,c){for(var d=b(a,c),e=[],f=0;f<d.length;f++)e.push(l(d[f]));return e}function d(a){for(var d=b(a,"trkseg"),e=[],f=0;f<d.length;f++)e.push(c(d[f],"trkpt"));return{type:"Feature",properties:j(a),geometry:{type:1===e.length?"LineString":"MultiLineString",coordinates:1===e.length?e[0]:e}}}function f(a){return{type:"Feature",properties:j(a),geometry:{type:"LineString",coordinates:c(a,"rtept")}}}function g(a){var b=j(a);return b.sym=i(e(a,"sym")),{type:"Feature",properties:b,geometry:{type:"Point",coordinates:l(a)}}}function j(a){var b,c=["name","desc","author","copyright","link","time","keywords"],d={};for(b=0;b<c.length;b++)d[c[b]]=i(e(a,c[b]));return h(d)}var k,n=b(a,"trk"),o=b(a,"rte"),p=b(a,"wpt"),q=m();for(k=0;k<n.length;k++)q.features.push(d(n[k]));for(k=0;k<o.length;k++)q.features.push(f(o[k]));for(k=0;k<p.length;k++)q.features.push(g(p[k]));return q}};return s}(),"undefined"!=typeof module&&(module.exports=toGeoJSON);;
!function(a){"object"==typeof exports?module.exports=a():"function"==typeof define&&define.amd?define(a):"undefined"!=typeof window?window.togpx=a():"undefined"!=typeof global?global.togpx=a():"undefined"!=typeof self&&(self.togpx=a())}(function(){return function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);throw new Error("Cannot find module '"+g+"'")}var j=c[g]={exports:{}};b[g][0].call(j.exports,function(a){var c=b[g][1][a];return e(c?c:a)},j,j.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b){function c(a,b){function c(a){if("object"==typeof a.tags){var b=c(a.tags);if(""!==b)return b}return a.name?a.name:a.ref?a.ref:a.id?a.id:""}function e(a){if("object"==typeof a.tags)return e(a.tags);var b="";for(var c in a)"object"!=typeof a[c]&&(b+=c+"="+a[c]+"\n");return b.substr(0,b.length-1)}function f(a,c){b.featureLink&&(a.link={"@href":b.featureLink(c.properties)})}b=function(a,b){for(var c in a)b.hasOwnProperty(c)&&(a[c]=b[c]);return a}({creator:"togpx",metadata:void 0,featureTitle:c,featureDescription:e,featureLink:void 0},b||{});var g={gpx:{"@xmlns":"http://www.topografix.com/GPX/1/1","@xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","@xsi:schemaLocation":"http://www.topografix.com/GPX/1/1 http://www.topografix.com/GPX/1/1/gpx.xsd","@version":"1.1",wpt:[],trk:[]}};b.creator&&(g.gpx["@creator"]=b.creator),b.metadata&&(g.gpx.metadata=b.metadata);var h;return h="FeatureCollection"===a.type?a.features:"Feature"===a.type?[a]:[{type:"Feature",properties:{},geometry:a}],h.forEach(function i(a){switch(a.geometry.type){case"Point":case"MultiPoint":var c=a.geometry.coordinates;"Point"==a.geometry.type&&(c=[c]),c.forEach(function(c){o={"@lat":c[1],"@lon":c[0],name:b.featureTitle(a.properties),desc:b.featureDescription(a.properties)},f(o,a),g.gpx.wpt.push(o)});break;case"LineString":case"MultiLineString":var c=a.geometry.coordinates;"LineString"==a.geometry.type&&(c=[c]),o={name:b.featureTitle(a.properties),desc:b.featureDescription(a.properties)},f(o,a),o.trkseg=[],c.forEach(function(a){var b={trkpt:[]};a.forEach(function(a){b.trkpt.push({"@lat":a[1],"@lon":a[0]})}),o.trkseg.push(b)}),g.gpx.trk.push(o);break;case"Polygon":case"MultiPolygon":o={name:b.featureTitle(a.properties),desc:b.featureDescription(a.properties)},f(o,a),o.trkseg=[];var c=a.geometry.coordinates;"Polygon"==a.geometry.type&&(c=[c]),c.forEach(function(a){a.forEach(function(a){var b={trkpt:[]};a.forEach(function(a){b.trkpt.push({"@lat":a[1],"@lon":a[0]})}),o.trkseg.push(b)})}),g.gpx.trk.push(o);break;case"GeometryCollection":a.geometry.geometries.forEach(function(b){var c={properties:a.properties,geometry:b};i(c)});break;default:console.log("warning: unsupported geometry type: "+a.geometry.type)}}),gpx_str=d.stringify(g),gpx_str}var d=a("jxon");b.exports=c},{jxon:2}],2:[function(a,b){"undefined"==typeof XMLSerializer&&(XMLSerializer=a("xmldom").XMLSerializer,document={},document.implementation=new(a("xmldom").DOMImplementation));var c=new function(){function a(a){return k.test(a)?null:l.test(a)?"true"===a.toLowerCase():isFinite(a)?parseFloat(a):isFinite(Date.parse(a))?new Date(a):a}function b(){}function d(a){return null===a?new b:a instanceof Object?a:new a.constructor(a)}function e(b,c,f,k){var l,m,n=j.length,o=b.hasChildNodes(),p=b.hasAttributes(),q=Boolean(2&c),r=0,s="",t=q?{}:!0;if(o)for(var u,v=0;v<b.childNodes.length;v++)u=b.childNodes.item(v),4===u.nodeType?s+=u.nodeValue:3===u.nodeType?s+=u.nodeValue.trim():1!==u.nodeType||u.prefix||j.push(u);var w=j.length,x=a(s);q||!o&&!p||(t=0===c?d(x):{});for(var y=n;w>y;y++)l=j[y].nodeName.toLowerCase(),m=e(j[y],c,f,k),t.hasOwnProperty(l)?(t[l].constructor!==Array&&(t[l]=[t[l]]),t[l].push(m)):(t[l]=m,r++);if(p){for(var z,A=b.attributes.length,B=k?"":i,C=k?{}:t,D=0;A>D;r++,D++)z=b.attributes.item(D),C[B+z.name.toLowerCase()]=a(z.value.trim());k&&(f&&Object.freeze(C),t[h]=C,r-=A-1)}return 3===c||(2===c||1===c&&r>0)&&s?t[g]=x:!q&&0===r&&s&&(t=x),f&&(q||r>0)&&Object.freeze(t),j.length=n,t}function f(a,b,c){var d,e;c instanceof String||c instanceof Number||c instanceof Boolean?b.appendChild(a.createTextNode(c.toString())):c.constructor===Date&&b.appendChild(a.createTextNode(c.toGMTString()));for(var j in c)if(d=c[j],!(isFinite(j)||d instanceof Function))if(j===g)null!==d&&d!==!0&&b.appendChild(a.createTextNode(d.constructor===Date?d.toGMTString():String(d)));else if(j===h)for(var k in d)b.setAttribute(k,d[k]);else if(j.charAt(0)===i)b.setAttribute(j.slice(1),d);else if(d.constructor===Array)for(var l=0;l<d.length;l++)e=a.createElement(j),f(a,e,d[l]),b.appendChild(e);else e=a.createElement(j),d instanceof Object?f(a,e,d):null!==d&&d!==!0&&e.appendChild(a.createTextNode(d.toString())),b.appendChild(e)}var g="keyValue",h="keyAttributes",i="@",j=[],k=/^\s*$/,l=/^(?:true|false)$/i;b.prototype.toString=function(){return"null"},b.prototype.valueOf=function(){return null},this.build=function(a,b,c,d){var f=arguments.length>1&&"number"==typeof b?3&b:1;return e(a,f,c||!1,arguments.length>3?d:3===f)},this.unbuild=function(a){var b=document.implementation.createDocument("","",null);return f(b,b,a),b},this.stringify=function(a){return(new XMLSerializer).serializeToString(c.unbuild(a))}};b.exports=c},{xmldom:3}],3:[function(){},{}]},{},[1])(1)});;
!function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;b="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,b.prettyData=a()}}(function(){return function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){function d(){this.shift=["\n"],this.step="  ";var a=100,b=0;for(b=0;a>b;b++)this.shift.push(this.shift[b]+this.step)}function e(a,b){return b-(a.replace(/\(/g,"").length-a.replace(/\)/g,"").length)}function f(a,b){return a.replace(/\s{1,}/g," ").replace(/ AND /gi,"~::~"+b+b+"AND ").replace(/ BETWEEN /gi,"~::~"+b+"BETWEEN ").replace(/ CASE /gi,"~::~"+b+"CASE ").replace(/ ELSE /gi,"~::~"+b+"ELSE ").replace(/ END /gi,"~::~"+b+"END ").replace(/ FROM /gi,"~::~FROM ").replace(/ GROUP\s{1,}BY/gi,"~::~GROUP BY ").replace(/ HAVING /gi,"~::~HAVING ").replace(/ IN /gi," IN ").replace(/ JOIN /gi,"~::~JOIN ").replace(/ CROSS~::~{1,}JOIN /gi,"~::~CROSS JOIN ").replace(/ INNER~::~{1,}JOIN /gi,"~::~INNER JOIN ").replace(/ LEFT~::~{1,}JOIN /gi,"~::~LEFT JOIN ").replace(/ RIGHT~::~{1,}JOIN /gi,"~::~RIGHT JOIN ").replace(/ ON /gi,"~::~"+b+"ON ").replace(/ OR /gi,"~::~"+b+b+"OR ").replace(/ ORDER\s{1,}BY/gi,"~::~ORDER BY ").replace(/ OVER /gi,"~::~"+b+"OVER ").replace(/\(\s{0,}SELECT /gi,"~::~(SELECT ").replace(/\)\s{0,}SELECT /gi,")~::~SELECT ").replace(/ THEN /gi," THEN~::~"+b).replace(/ UNION /gi,"~::~UNION~::~").replace(/ USING /gi,"~::~USING ").replace(/ WHEN /gi,"~::~"+b+"WHEN ").replace(/ WHERE /gi,"~::~WHERE ").replace(/ WITH /gi,"~::~WITH ").replace(/ ALL /gi," ALL ").replace(/ AS /gi," AS ").replace(/ ASC /gi," ASC ").replace(/ DESC /gi," DESC ").replace(/ DISTINCT /gi," DISTINCT ").replace(/ EXISTS /gi," EXISTS ").replace(/ NOT /gi," NOT ").replace(/ NULL /gi," NULL ").replace(/ LIKE /gi," LIKE ").replace(/\s{0,}SELECT /gi,"SELECT ").replace(/~::~{1,}/g,"~::~").split("~::~")}d.prototype.xml=function(a){var b=a.replace(/>\s{0,}</g,"><").replace(/</g,"~::~<").replace(/xmlns\:/g,"~::~xmlns:").replace(/xmlns\=/g,"~::~xmlns=").split("~::~"),c=b.length,d=!1,e=0,f="",g=0;for(g=0;c>g;g++)b[g].search(/<!/)>-1?(f+=this.shift[e]+b[g],d=!0,(b[g].search(/-->/)>-1||b[g].search(/\]>/)>-1||b[g].search(/!DOCTYPE/)>-1)&&(d=!1)):b[g].search(/-->/)>-1||b[g].search(/\]>/)>-1?(f+=b[g],d=!1):/^<\w/.exec(b[g-1])&&/^<\/\w/.exec(b[g])&&/^<[\w:\-\.\,]+/.exec(b[g-1])==/^<\/[\w:\-\.\,]+/.exec(b[g])[0].replace("/","")?(f+=b[g],d||e--):b[g].search(/<\w/)>-1&&-1==b[g].search(/<\//)&&-1==b[g].search(/\/>/)?f=f+=d?b[g]:this.shift[e++]+b[g]:b[g].search(/<\w/)>-1&&b[g].search(/<\//)>-1?f=f+=d?b[g]:this.shift[e]+b[g]:b[g].search(/<\//)>-1?f=f+=d?b[g]:this.shift[--e]+b[g]:b[g].search(/\/>/)>-1?f=f+=d?b[g]:this.shift[e]+b[g]:f+=b[g].search(/<\?/)>-1?this.shift[e]+b[g]:b[g].search(/xmlns\:/)>-1||b[g].search(/xmlns\=/)>-1?this.shift[e]+b[g]:b[g];return"\n"==f[0]?f.slice(1):f},d.prototype.json=function(a){return"string"==typeof a?JSON.stringify(JSON.parse(a),null,this.step):"object"==typeof a?JSON.stringify(a,null,this.step):null},d.prototype.css=function(a){var b=a.replace(/\s{1,}/g," ").replace(/\{/g,"{~::~").replace(/\}/g,"~::~}~::~").replace(/\;/g,";~::~").replace(/\/\*/g,"~::~/*").replace(/\*\//g,"*/~::~").replace(/~::~\s{0,}~::~/g,"~::~").split("~::~"),c=b.length,d=0,e="",f=0;for(f=0;c>f;f++)e+=/\{/.exec(b[f])?this.shift[d++]+b[f]:/\}/.exec(b[f])?this.shift[--d]+b[f]:/\*\\/.exec(b[f])?this.shift[d]+b[f]:this.shift[d]+b[f];return e.replace(/^\n{1,}/,"")},d.prototype.sql=function(a){var b=a.replace(/\s{1,}/g," ").replace(/\'/gi,"~::~'").split("~::~"),c=b.length,d=[],g=0,h=this.step,i=0,j="",k=0;for(k=0;c>k;k++)d=d.concat(k%2?b[k]:f(b[k],h));for(c=d.length,k=0;c>k;k++)i=e(d[k],i),/\s{0,}\s{0,}SELECT\s{0,}/.exec(d[k])&&(d[k]=d[k].replace(/\,/g,",\n"+h+h)),/\s{0,}\(\s{0,}SELECT\s{0,}/.exec(d[k])?(g++,j+=this.shift[g]+d[k]):/\'/.exec(d[k])?(1>i&&g&&g--,j+=d[k]):(j+=this.shift[g]+d[k],1>i&&g&&g--);return j=j.replace(/^\n{1,}/,"").replace(/\n{1,}/g,"\n")},d.prototype.xmlmin=function(a,b){var c=b?a:a.replace(/\<![ \r\n\t]*(--([^\-]|[\r\n]|-[^\-])*--[ \r\n\t]*)\>/g,"");return c.replace(/>\s{0,}</g,"><")},d.prototype.jsonmin=function(a){return a.replace(/\s{0,}\{\s{0,}/g,"{").replace(/\s{0,}\[$/g,"[").replace(/\[\s{0,}/g,"[").replace(/:\s{0,}\[/g,":[").replace(/\s{0,}\}\s{0,}/g,"}").replace(/\s{0,}\]\s{0,}/g,"]").replace(/\"\s{0,}\,/g,'",').replace(/\,\s{0,}\"/g,',"').replace(/\"\s{0,}:/g,'":').replace(/:\s{0,}\"/g,':"').replace(/:\s{0,}\[/g,":[").replace(/\,\s{0,}\[/g,",[").replace(/\,\s{2,}/g,", ").replace(/\]\s{0,},\s{0,}\[/g,"],[")},d.prototype.cssmin=function(a,b){var c=b?a:a.replace(/\/\*([^*]|[\r\n]|(\*+([^*/]|[\r\n])))*\*+\//g,"");return c.replace(/\s{1,}/g," ").replace(/\{\s{1,}/g,"{").replace(/\}\s{1,}/g,"}").replace(/\;\s{1,}/g,";").replace(/\/\*\s{1,}/g,"/*").replace(/\*\/\s{1,}/g,"*/")},d.prototype.sqlmin=function(a){return a.replace(/\s{1,}/g," ").replace(/\s{1,}\(/,"(").replace(/\s{1,}\)/,")")},c.pd=new d,b.exports=new d},{}]},{},[1])(1)});;
!function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;b="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,b.tokml=a()}}(function(){return function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b){function c(a){return function(b){var c="",d="";if(a.simplestyle&&p(b.properties)&&(c=m(b.properties),d=t("styleUrl","#"+q(b.properties))),!b.properties||!v.valid(b.geometry))return"";var e=v.any(b.geometry);return e?c+t("Placemark",g(b.properties,a)+h(b.properties,a)+k(b.properties)+i(b.properties,a)+e+d):""}}function d(a,b){if(!a.type)return"";switch(a.type){case"FeatureCollection":return a.features?a.features.map(c(b)).join(""):"";case"Feature":return c(b)(a);default:return c(b)({type:"Feature",geometry:a,properties:{}})}}function e(a){return void 0!==a.documentName?t("name",a.documentName):""}function f(a){return void 0!==a.documentDescription?t("description",a.documentDescription):""}function g(a,b){return a[b.name]?t("name",u(a[b.name])):""}function h(a,b){return a[b.description]?t("description",u(a[b.description])):""}function i(a,b){return a[b.timestamp]?t("TimeStamp",t("when",u(a[b.timestamp]))):""}function j(a){return a.map(function(a){return a.join(",")}).join(" ")}function k(a){return t("ExtendedData",r(a).map(l).join(""))}function l(a){return t("Data",t("value",u(a[1])),[["name",u(a[0])]])}function m(a){return t("Style",t("IconStyle",t("Icon",t("href",n(a))))+o(a),[["id",q(a)]])}function n(a){var b=a["marker-size"]||"medium",c=a["marker-symbol"]?"-"+a["marker-symbol"]:"",d=(a["marker-color"]||"7e7e7e").replace("#","");return"https://api.tiles.mapbox.com/v3/marker/pin-"+b.charAt(0)+c+"+"+d+".png"}function o(){return t("hotSpot","",[["xunits","fraction"],["yunits","fraction"],["x",.5],["y",.5]])}function p(a){return!!(a["marker-size"]||a["marker-symbol"]||a["marker-color"])}function q(a){return(a["marker-symbol"]||"")+(a["marker-color"]||"").replace("#","")+(a["marker-size"]||"")}function r(a){var b=[];for(var c in a)b.push([c,a[c]]);return b}var s=a("strxml"),t=s.tag,u=s.encode;b.exports=function(a,b){return b=b||{documentName:void 0,documentDescription:void 0,name:"name",description:"description",simplestyle:!1,timestamp:"timestamp"},'<?xml version="1.0" encoding="UTF-8"?>'+t("kml",t("Document",e(b)+f(b)+d(a,b)),[["xmlns","http://www.opengis.net/kml/2.2"]])};var v={Point:function(a){return t("Point",t("coordinates",a.coordinates.join(",")))},LineString:function(a){return t("LineString",t("coordinates",j(a.coordinates)))},Polygon:function(a){if(!a.coordinates.length)return"";var b=a.coordinates[0],c=a.coordinates.slice(1),d=t("outerBoundaryIs",t("LinearRing",t("coordinates",j(b)))),e=c.map(function(a){return t("innerBoundaryIs",t("LinearRing",t("coordinates",j(a))))}).join("");return t("Polygon",d+e)},MultiPoint:function(a){return a.coordinates.length?t("MultiGeometry",a.coordinates.map(function(a){return v.Point({coordinates:a})}).join("")):""},MultiPolygon:function(a){return a.coordinates.length?t("MultiGeometry",a.coordinates.map(function(a){return v.Polygon({coordinates:a})}).join("")):""},MultiLineString:function(a){return a.coordinates.length?t("MultiGeometry",a.coordinates.map(function(a){return v.LineString({coordinates:a})}).join("")):""},GeometryCollection:function(a){return t("MultiGeometry",a.geometries.map(v.any).join(""))},valid:function(a){return a&&a.type&&(a.coordinates||"GeometryCollection"===a.type&&a.geometries.every(v.valid))},any:function(a){return v[a.type]?v[a.type](a):""}}},{strxml:2}],2:[function(a,b){function c(a){return a&&a.length?" "+a.map(function(a){return a[0]+'="'+a[1]+'"'}).join(" "):""}function d(a,b){return"<"+a+c(b)+"/>"}function e(a,b,d){return"<"+a+c(d)+">"+b+"</"+a+">"}function f(a){return(null===a?"":a.toString()).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}b.exports.attr=c,b.exports.tagClose=d,b.exports.tag=e,b.exports.encode=f},{}]},{},[1])(1)});;
!function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;b="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,b.geojsonToPath=a()}}(function(){return function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b){function c(a){var b,c=[];return b="FeatureCollection"===a.type?a.features:"Feature"===a.type?[a]:[{type:"Feature",properties:{},geometry:a}],b.forEach(function(a){switch(a.geometry.type){case"LineString":case"MultiLineString":var b=a.geometry.coordinates;"LineString"==a.geometry.type&&(b=[b]),b.forEach(function(a){a.forEach(function(a){c.push(""+a[1]+","+a[0])})});break;default:console.log("warning: unsupported geometry type: "+a.geometry.type)}}),gpx_str=c.join(":"),gpx_str}b.exports=c},{}]},{},[1])(1)});;
var FileLoader=L.Class.extend({includes:L.Mixin.Events,options:{layerOptions:{},fileSizeLimit:1024},initialize:function(a,b){this._map=a,L.Util.setOptions(this,b),this._parsers={geojson:this._loadGeoJSON,gpx:this._convertToGeoJSON,kml:this._convertToGeoJSON}},load:function(a){var b=(a.size/1024).toFixed(4);if(b>this.options.fileSizeLimit)return void this.fire("data:error",{error:new Error("File size exceeds limit ("+b+" > "+this.options.fileSizeLimit+"kb)")});var c=a.name.split(".").pop(),d=this._parsers[c];if(!d)return void this.fire("data:error",{error:new Error("Unsupported file type "+a.type+"("+c+")")});var e=new FileReader;return e.onload=L.Util.bind(function(b){try{this.fire("data:loading",{filename:a.name,format:c});var e=d.call(this,b.target.result,c);this.fire("data:loaded",{layer:e,filename:a.name,format:c})}catch(f){this.fire("data:error",{error:f})}},this),e.readAsText(a),e},_loadGeoJSON:function(a){"string"==typeof a&&(a=JSON.parse(a));var b=L.geoJson(a,this.options.layerOptions);if(0===b.getLayers().length)throw new Error("GeoJSON has no valid layers.");return this.options.addToMap&&b.addTo(this._map),b},_convertToGeoJSON:function(a,b){"string"==typeof a&&(a=(new window.DOMParser).parseFromString(a,"text/xml"));var c=toGeoJSON[b](a);return this._loadGeoJSON(c)}});L.Control.FileLayerLoad=L.Control.extend({statics:{TITLE:"Load local file (GPX, KML, GeoJSON)",LABEL:"&#8965;"},options:{position:"topleft",fitBounds:!0,layerOptions:{},addToMap:!0,fileSizeLimit:1024},initialize:function(a){L.Util.setOptions(this,a),this.loader=null},onAdd:function(a){return this.loader=new FileLoader(a,this.options),this.loader.on("data:loaded",function(b){this.options.fitBounds&&window.setTimeout(function(){a.fitBounds(b.layer.getBounds())},500)},this),this._initDragAndDrop(a),this._initContainer()},_initDragAndDrop:function(a){var b=this.loader,c=a._container,d={dragenter:function(){a.scrollWheelZoom.disable()},dragleave:function(){a.scrollWheelZoom.enable()},dragover:function(a){a.stopPropagation(),a.preventDefault()},drop:function(c){c.stopPropagation(),c.preventDefault();{var d=Array.prototype.slice.apply(c.dataTransfer.files);d.length}setTimeout(function(){b.load(d.shift()),d.length>0&&setTimeout(arguments.callee,25)},25),a.scrollWheelZoom.enable()}};for(var e in d)c.addEventListener(e,d[e],!1)},_initContainer:function(){var a="leaflet-control-filelayer leaflet-control-zoom",b="leaflet-bar",c=b+"-part",d=L.DomUtil.create("div",a+" "+b),e=L.DomUtil.create("a",a+"-in "+c,d);e.innerHTML=L.Control.FileLayerLoad.LABEL,e.href="#",e.title=L.Control.FileLayerLoad.TITLE;var f=L.DomUtil.create("input","hidden",d);f.type="file",f.accept=".gpx,.kml,.geojson",f.style.display="none";var g=this.loader;return f.addEventListener("change",function(){g.load(this.files[0]),this.value=""},!1),L.DomEvent.disableClickPropagation(e),L.DomEvent.on(e,"click",function(a){f.click(),a.preventDefault()}),d}}),L.Control.fileLayerLoad=function(a){return new L.Control.FileLayerLoad(a)};;
var saveAs=saveAs||"undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob.bind(navigator)||function(a){"use strict";if("undefined"==typeof navigator||!/MSIE [1-9]\./.test(navigator.userAgent)){var b=a.document,c=function(){return a.URL||a.webkitURL||a},d=b.createElementNS("http://www.w3.org/1999/xhtml","a"),e=!a.externalHost&&"download"in d,f=function(c){var d=b.createEvent("MouseEvents");d.initMouseEvent("click",!0,!1,a,0,0,0,0,0,!1,!1,!1,!1,0,null),c.dispatchEvent(d)},g=a.webkitRequestFileSystem,h=a.requestFileSystem||g||a.mozRequestFileSystem,i=function(b){(a.setImmediate||a.setTimeout)(function(){throw b},0)},j="application/octet-stream",k=0,l=[],m=function(){for(var a=l.length;a--;){var b=l[a];"string"==typeof b?c().revokeObjectURL(b):b.remove()}l.length=0},n=function(a,b,c){b=[].concat(b);for(var d=b.length;d--;){var e=a["on"+b[d]];if("function"==typeof e)try{e.call(a,c||a)}catch(f){i(f)}}},o=function(b,i){var m,o,p,q=this,r=b.type,s=!1,t=function(){var a=c().createObjectURL(b);return l.push(a),a},u=function(){n(q,"writestart progress write writeend".split(" "))},v=function(){(s||!m)&&(m=t(b)),o?o.location.href=m:window.open(m,"_blank"),q.readyState=q.DONE,u()},w=function(a){return function(){return q.readyState!==q.DONE?a.apply(this,arguments):void 0}},x={create:!0,exclusive:!1};return q.readyState=q.INIT,i||(i="download"),e?(m=t(b),d.href=m,d.download=i,f(d),q.readyState=q.DONE,void u()):(a.chrome&&r&&r!==j&&(p=b.slice||b.webkitSlice,b=p.call(b,0,b.size,j),s=!0),g&&"download"!==i&&(i+=".download"),(r===j||g)&&(o=a),h?(k+=b.size,void h(a.TEMPORARY,k,w(function(a){a.root.getDirectory("saved",x,w(function(a){var c=function(){a.getFile(i,x,w(function(a){a.createWriter(w(function(c){c.onwriteend=function(b){o.location.href=a.toURL(),l.push(a),q.readyState=q.DONE,n(q,"writeend",b)},c.onerror=function(){var a=c.error;a.code!==a.ABORT_ERR&&v()},"writestart progress write abort".split(" ").forEach(function(a){c["on"+a]=q["on"+a]}),c.write(b),q.abort=function(){c.abort(),q.readyState=q.DONE},q.readyState=q.WRITING}),v)}),v)};a.getFile(i,{create:!1},w(function(a){a.remove(),c()}),w(function(a){a.code===a.NOT_FOUND_ERR?c():v()}))}),v)}),v)):void v())},p=o.prototype,q=function(a,b){return new o(a,b)};return p.abort=function(){var a=this;a.readyState=a.DONE,n(a,"abort")},p.readyState=p.INIT=0,p.WRITING=1,p.DONE=2,p.error=p.onwritestart=p.onprogress=p.onwrite=p.onabort=p.onerror=p.onwriteend=null,a.addEventListener("unload",m,!1),q.unload=function(){m(),a.removeEventListener("unload",m,!1)},q}}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content);"undefined"!=typeof module&&null!==module?module.exports=saveAs:"undefined"!=typeof define&&null!==define&&null!=define.amd&&define([],function(){return saveAs});;
!function(e){if("function"==typeof bootstrap)bootstrap("simplifygeometry",e);else if("object"==typeof exports)module.exports=e();else if("function"==typeof define&&define.amd)define(e);else if("undefined"!=typeof ses){if(!ses.ok())return;ses.makeSimplifyGeometry=e}else"undefined"!=typeof window?window.simplifyGeometry=e():global.simplifyGeometry=e()}(function(){return function(e,t,n){function i(n,s){if(!t[n]){if(!e[n]){var o="function"==typeof require&&require;if(!s&&o)return o(n,!0);if(r)return r(n,!0);throw new Error("Cannot find module '"+n+"'")}var u=t[n]={exports:{}};e[n][0].call(u.exports,function(t){var r=e[n][1][t];return i(r?r:t)},u,u.exports)}return t[n].exports}for(var r="function"==typeof require&&require,s=0;s<n.length;s++)i(n[s]);return i}({1:[function(require,module){var Line=require("./line"),simplifyGeometry=function(points,tolerance){for(var dmax=0,index=0,i=1;i<=points.length-2;i++)d=new Line(points[0],points[points.length-1]).perpendicularDistance(points[i]),d>dmax&&(index=i,dmax=d);if(dmax>tolerance)var results_one=simplifyGeometry(points.slice(0,index),tolerance),results_two=simplifyGeometry(points.slice(index,points.length),tolerance),results=results_one.concat(results_two);else results=points.length>1?[points[0],points[points.length-1]]:[points[0]];return results};module.exports=simplifyGeometry},{"./line":2}],2:[function(require,module){var Line=function(p1,p2){this.p1=p1,this.p2=p2};Line.prototype.rise=function(){return this.p2[1]-this.p1[1]},Line.prototype.run=function(){return this.p2[0]-this.p1[0]},Line.prototype.slope=function(){return this.rise()/this.run()},Line.prototype.yIntercept=function(){return this.p1[1]-this.p1[0]*this.slope(this.p1,this.p2)},Line.prototype.isVertical=function(){return!isFinite(this.slope())},Line.prototype.isHorizontal=function(){return this.p1[1]==this.p2[1]},Line.prototype._perpendicularDistanceHorizontal=function(point){return Math.abs(this.p1[1]-point[1])},Line.prototype._perpendicularDistanceVertical=function(point){return Math.abs(this.p1[0]-point[0])},Line.prototype._perpendicularDistanceHasSlope=function(point){var slope=this.slope(),y_intercept=this.yIntercept();return Math.abs(slope*point[0]-point[1]+y_intercept)/Math.sqrt(Math.pow(slope,2)+1)},Line.prototype.perpendicularDistance=function(point){return this.isVertical()?this._perpendicularDistanceVertical(point):this.isHorizontal()?this._perpendicularDistanceHorizontal(point):this._perpendicularDistanceHasSlope(point)},module.exports=Line},{}]},{},[1])(1)});;
!function(a){function b(b,d){if(g[b]){var e=c(this),f=g[b].apply(e,d);return"undefined"==typeof f?a(this):f}throw new Error("method '"+b+"()' does not exist for slider.")}function c(b){var c=a(b).data("slider");if(c&&c instanceof f)return c;throw new Error(e.callingContextNotSliderInstance)}function d(b){var c=a(this);return c.each(function(){var c=a(this),d=c.data("slider"),e="object"==typeof b&&b;d&&!e&&(e={},a.each(a.fn.slider.defaults,function(a){e[a]=d[a]})),c.data("slider",new f(this,a.extend({},a.fn.slider.defaults,e)))}),c}var e={formatInvalidInputErrorMsg:function(a){return"Invalid input value '"+a+"' passed in"},callingContextNotSliderInstance:"Calling context element does not have instance of Slider bound to it. Check your code to make sure the JQuery object returned from the call to the slider() initializer is calling the method"},f=function(b,c){var d=this.element=a(b).hide(),e=a(b)[0].style.width,f=!1,g=this.element.parent();g.hasClass("slider")===!0?(f=!0,this.picker=g):this.picker=a('<div class="slider"><div class="slider-track"><div class="slider-selection"></div><div class="slider-handle"></div><div class="slider-handle"></div></div><div id="tooltip" class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div><div id="tooltip_min" class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div><div id="tooltip_max" class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div></div>').insertBefore(this.element).append(this.element),this.id=this.element.data("slider-id")||c.id,this.id&&(this.picker[0].id=this.id),("ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch)&&(this.touchCapable=!0);var h=this.element.data("slider-tooltip")||c.tooltip;switch(this.tooltip=this.picker.find("#tooltip"),this.tooltipInner=this.tooltip.find("div.tooltip-inner"),this.tooltip_min=this.picker.find("#tooltip_min"),this.tooltipInner_min=this.tooltip_min.find("div.tooltip-inner"),this.tooltip_max=this.picker.find("#tooltip_max"),this.tooltipInner_max=this.tooltip_max.find("div.tooltip-inner"),f===!0&&(this.picker.removeClass("slider-horizontal"),this.picker.removeClass("slider-vertical"),this.tooltip.removeClass("hide"),this.tooltip_min.removeClass("hide"),this.tooltip_max.removeClass("hide")),this.orientation=this.element.data("slider-orientation")||c.orientation,this.orientation){case"vertical":this.picker.addClass("slider-vertical"),this.stylePos="top",this.mousePos="pageY",this.sizePos="offsetHeight",this.tooltip.addClass("right")[0].style.left="100%",this.tooltip_min.addClass("right")[0].style.left="100%",this.tooltip_max.addClass("right")[0].style.left="100%";break;default:this.picker.addClass("slider-horizontal").css("width",e),this.orientation="horizontal",this.stylePos="left",this.mousePos="pageX",this.sizePos="offsetWidth",this.tooltip.addClass("top")[0].style.top=-this.tooltip.outerHeight()-14+"px",this.tooltip_min.addClass("top")[0].style.top=-this.tooltip_min.outerHeight()-14+"px",this.tooltip_max.addClass("top")[0].style.top=-this.tooltip_max.outerHeight()-14+"px"}var i=this;switch(a.each(["min","max","step","precision","value","reversed","handle"],function(a,b){i[b]="undefined"!=typeof d.data("slider-"+b)?d.data("slider-"+b):"undefined"!=typeof c[b]?c[b]:"undefined"!=typeof d.prop(b)?d.prop(b):0}),this.value instanceof Array?f&&!this.range?this.value=this.value[0]:this.range=!0:this.range&&(this.value=[this.value,this.max]),this.selection=this.element.data("slider-selection")||c.selection,this.selectionEl=this.picker.find(".slider-selection"),"none"===this.selection&&this.selectionEl.addClass("hide"),this.selectionElStyle=this.selectionEl[0].style,this.handle1=this.picker.find(".slider-handle:first"),this.handle1Stype=this.handle1[0].style,this.handle2=this.picker.find(".slider-handle:last"),this.handle2Stype=this.handle2[0].style,f===!0&&(this.handle1.removeClass("round triangle"),this.handle2.removeClass("round triangle hide")),this.handle){case"round":this.handle1.addClass("round"),this.handle2.addClass("round");break;case"triangle":this.handle1.addClass("triangle"),this.handle2.addClass("triangle")}this.offset=this.picker.offset(),this.size=this.picker[0][this.sizePos],this.formater=c.formater,this.tooltip_separator=c.tooltip_separator,this.tooltip_split=c.tooltip_split,this.setValue(this.value),this.handle1.on({keydown:a.proxy(this.keydown,this,0)}),this.handle2.on({keydown:a.proxy(this.keydown,this,1)}),this.touchCapable&&this.picker.on({touchstart:a.proxy(this.mousedown,this)}),this.picker.on({mousedown:a.proxy(this.mousedown,this)}),"hide"===h?(this.tooltip.addClass("hide"),this.tooltip_min.addClass("hide"),this.tooltip_max.addClass("hide")):"always"===h?(this.showTooltip(),this.alwaysShowTooltip=!0):(this.picker.on({mouseenter:a.proxy(this.showTooltip,this),mouseleave:a.proxy(this.hideTooltip,this)}),this.handle1.on({focus:a.proxy(this.showTooltip,this),blur:a.proxy(this.hideTooltip,this)}),this.handle2.on({focus:a.proxy(this.showTooltip,this),blur:a.proxy(this.hideTooltip,this)})),this.enabled=c.enabled&&(void 0===this.element.data("slider-enabled")||this.element.data("slider-enabled")===!0),this.enabled?this.enable():this.disable(),this.natural_arrow_keys=this.element.data("slider-natural_arrow_keys")||c.natural_arrow_keys};f.prototype={constructor:f,over:!1,inDrag:!1,showTooltip:function(){this.tooltip_split===!1?this.tooltip.addClass("in"):(this.tooltip_min.addClass("in"),this.tooltip_max.addClass("in")),this.over=!0},hideTooltip:function(){this.inDrag===!1&&this.alwaysShowTooltip!==!0&&(this.tooltip.removeClass("in"),this.tooltip_min.removeClass("in"),this.tooltip_max.removeClass("in")),this.over=!1},layout:function(){var a;if(a=this.reversed?[100-this.percentage[0],this.percentage[1]]:[this.percentage[0],this.percentage[1]],this.handle1Stype[this.stylePos]=a[0]+"%",this.handle2Stype[this.stylePos]=a[1]+"%","vertical"===this.orientation)this.selectionElStyle.top=Math.min(a[0],a[1])+"%",this.selectionElStyle.height=Math.abs(a[0]-a[1])+"%";else{this.selectionElStyle.left=Math.min(a[0],a[1])+"%",this.selectionElStyle.width=Math.abs(a[0]-a[1])+"%";var b=this.tooltip_min[0].getBoundingClientRect(),c=this.tooltip_max[0].getBoundingClientRect();b.right>c.left?(this.tooltip_max.removeClass("top"),this.tooltip_max.addClass("bottom")[0].style.top="18px"):(this.tooltip_max.removeClass("bottom"),this.tooltip_max.addClass("top")[0].style.top="-30px")}this.range?(this.tooltipInner.text(this.formater(this.value[0])+this.tooltip_separator+this.formater(this.value[1])),this.tooltip[0].style[this.stylePos]=this.size*(a[0]+(a[1]-a[0])/2)/100-("vertical"===this.orientation?this.tooltip.outerHeight()/2:this.tooltip.outerWidth()/2)+"px",this.tooltipInner_min.text(this.formater(this.value[0])),this.tooltipInner_max.text(this.formater(this.value[1])),this.tooltip_min[0].style[this.stylePos]=this.size*(a[0]/100)-("vertical"===this.orientation?this.tooltip_min.outerHeight()/2:this.tooltip_min.outerWidth()/2)+"px",this.tooltip_max[0].style[this.stylePos]=this.size*(a[1]/100)-("vertical"===this.orientation?this.tooltip_max.outerHeight()/2:this.tooltip_max.outerWidth()/2)+"px"):(this.tooltipInner.text(this.formater(this.value[0])),this.tooltip[0].style[this.stylePos]=this.size*a[0]/100-("vertical"===this.orientation?this.tooltip.outerHeight()/2:this.tooltip.outerWidth()/2)+"px")},mousedown:function(b){if(!this.isEnabled())return!1;this.touchCapable&&"touchstart"===b.type&&(b=b.originalEvent),this.triggerFocusOnHandle(),this.offset=this.picker.offset(),this.size=this.picker[0][this.sizePos];var c=this.getPercentage(b);if(this.range){var d=Math.abs(this.percentage[0]-c),e=Math.abs(this.percentage[1]-c);this.dragged=e>d?0:1}else this.dragged=0;this.percentage[this.dragged]=this.reversed?100-c:c,this.layout(),this.touchCapable&&a(document).on({touchmove:a.proxy(this.mousemove,this),touchend:a.proxy(this.mouseup,this)}),a(document).on({mousemove:a.proxy(this.mousemove,this),mouseup:a.proxy(this.mouseup,this)}),this.inDrag=!0;var f=this.calculateValue();return this.element.trigger({type:"slideStart",value:f}).data("value",f).prop("value",f),this.setValue(f),!0},triggerFocusOnHandle:function(a){0===a&&this.handle1.focus(),1===a&&this.handle2.focus()},keydown:function(a,b){if(!this.isEnabled())return!1;var c;switch(b.which){case 37:case 40:c=-1;break;case 39:case 38:c=1}if(c){this.natural_arrow_keys&&("vertical"===this.orientation&&!this.reversed||"horizontal"===this.orientation&&this.reversed)&&(c=-1*c);var d=c*this.percentage[2],e=this.percentage[a]+d;e>100?e=100:0>e&&(e=0),this.dragged=a,this.adjustPercentageForRangeSliders(e),this.percentage[this.dragged]=e,this.layout();var f=this.calculateValue();return this.element.trigger({type:"slideStart",value:f}).data("value",f).prop("value",f),this.setValue(f,!0),this.element.trigger({type:"slideStop",value:f}).data("value",f).prop("value",f),!1}},mousemove:function(a){if(!this.isEnabled())return!1;this.touchCapable&&"touchmove"===a.type&&(a=a.originalEvent);var b=this.getPercentage(a);this.adjustPercentageForRangeSliders(b),this.percentage[this.dragged]=this.reversed?100-b:b,this.layout();var c=this.calculateValue();return this.setValue(c,!0),!1},adjustPercentageForRangeSliders:function(a){this.range&&(0===this.dragged&&this.percentage[1]<a?(this.percentage[0]=this.percentage[1],this.dragged=1):1===this.dragged&&this.percentage[0]>a&&(this.percentage[1]=this.percentage[0],this.dragged=0))},mouseup:function(){if(!this.isEnabled())return!1;this.touchCapable&&a(document).off({touchmove:this.mousemove,touchend:this.mouseup}),a(document).off({mousemove:this.mousemove,mouseup:this.mouseup}),this.inDrag=!1,this.over===!1&&this.hideTooltip();var b=this.calculateValue();return this.layout(),this.element.data("value",b).prop("value",b).trigger({type:"slideStop",value:b}),!1},calculateValue:function(){var a;return this.range?(a=[this.min,this.max],0!==this.percentage[0]&&(a[0]=Math.max(this.min,this.min+Math.round(this.diff*this.percentage[0]/100/this.step)*this.step),a[0]=this.applyPrecision(a[0])),100!==this.percentage[1]&&(a[1]=Math.min(this.max,this.min+Math.round(this.diff*this.percentage[1]/100/this.step)*this.step),a[1]=this.applyPrecision(a[1])),this.value=a):(a=this.min+Math.round(this.diff*this.percentage[0]/100/this.step)*this.step,a<this.min?a=this.min:a>this.max&&(a=this.max),a=parseFloat(a),a=this.applyPrecision(a),this.value=[a,this.value[1]]),a},applyPrecision:function(a){var b=this.precision||this.getNumDigitsAfterDecimalPlace(this.step);return this.applyToFixedAndParseFloat(a,b)},getNumDigitsAfterDecimalPlace:function(a){var b=(""+a).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);return b?Math.max(0,(b[1]?b[1].length:0)-(b[2]?+b[2]:0)):0},applyToFixedAndParseFloat:function(a,b){var c=a.toFixed(b);return parseFloat(c)},getPercentage:function(a){!this.touchCapable||"touchstart"!==a.type&&"touchmove"!==a.type||(a=a.touches[0]);var b=100*(a[this.mousePos]-this.offset[this.stylePos])/this.size;return b=Math.round(b/this.percentage[2])*this.percentage[2],Math.max(0,Math.min(100,b))},getValue:function(){return this.range?this.value:this.value[0]},setValue:function(a,b){if(a||(a=0),this.value=this.validateInputValue(a),this.range?(this.value[0]=this.applyPrecision(this.value[0]),this.value[1]=this.applyPrecision(this.value[1]),this.value[0]=Math.max(this.min,Math.min(this.max,this.value[0])),this.value[1]=Math.max(this.min,Math.min(this.max,this.value[1]))):(this.value=this.applyPrecision(this.value),this.value=[Math.max(this.min,Math.min(this.max,this.value))],this.handle2.addClass("hide"),this.value[1]="after"===this.selection?this.max:this.min),this.diff=this.max-this.min,this.percentage=this.diff>0?[100*(this.value[0]-this.min)/this.diff,100*(this.value[1]-this.min)/this.diff,100*this.step/this.diff]:[0,0,100],this.layout(),b===!0){var c=this.range?this.value:this.value[0];this.element.trigger({type:"slide",value:c}).data("value",c).prop("value",c)}},validateInputValue:function(b){if("number"==typeof b)return b;if(b instanceof Array)return a.each(b,function(a,b){if("number"!=typeof b)throw new Error(e.formatInvalidInputErrorMsg(b))}),b;throw new Error(e.formatInvalidInputErrorMsg(b))},destroy:function(){this.handle1.off(),this.handle2.off(),this.element.off().show().insertBefore(this.picker),this.picker.off().remove(),a(this.element).removeData("slider")},disable:function(){this.enabled=!1,this.handle1.removeAttr("tabindex"),this.handle2.removeAttr("tabindex"),this.picker.addClass("slider-disabled"),this.element.trigger("slideDisabled")},enable:function(){this.enabled=!0,this.handle1.attr("tabindex",0),this.handle2.attr("tabindex",0),this.picker.removeClass("slider-disabled"),this.element.trigger("slideEnabled")},toggle:function(){this.enabled?this.disable():this.enable()},isEnabled:function(){return this.enabled},setAttribute:function(a,b){this[a]=b},getAttribute:function(a){return this[a]}};var g={getValue:f.prototype.getValue,setValue:f.prototype.setValue,setAttribute:f.prototype.setAttribute,getAttribute:f.prototype.getAttribute,destroy:f.prototype.destroy,disable:f.prototype.disable,enable:f.prototype.enable,toggle:f.prototype.toggle,isEnabled:f.prototype.isEnabled};a.fn.slider=function(a){if("string"==typeof a&&"refresh"!==a){var c=Array.prototype.slice.call(arguments,1);return b.call(this,a,c)}return d.call(this,a)},a.fn.slider.defaults={min:0,max:10,step:1,precision:0,orientation:"horizontal",value:5,range:!1,selection:"before",tooltip:"show",tooltip_separator:":",tooltip_split:!1,natural_arrow_keys:!1,handle:"round",reversed:!1,enabled:!0,formater:function(a){return a}},a.fn.slider.Constructor=f}(window.jQuery);;
!function(a){"use strict";"function"==typeof define&&define.amd?define(["jquery"],a):a("object"==typeof exports&&"function"==typeof require?require("jquery"):jQuery)}(function(a){"use strict";function b(c,d){var e=function(){},f=this,g={ajaxSettings:{},autoSelectFirst:!1,appendTo:document.body,serviceUrl:null,lookup:null,onSelect:null,width:"auto",minChars:1,maxHeight:300,deferRequestBy:0,params:{},formatResult:b.formatResult,delimiter:null,zIndex:9999,type:"GET",noCache:!1,onSearchStart:e,onSearchComplete:e,onSearchError:e,preserveInput:!1,containerClass:"autocomplete-suggestions",tabDisabled:!1,dataType:"text",currentRequest:null,triggerSelectOnValidInput:!0,preventBadQueries:!0,lookupFilter:function(a,b,c){return-1!==a.value.toLowerCase().indexOf(c)},paramName:"query",transformResult:function(b){return"string"==typeof b?a.parseJSON(b):b},showNoSuggestionNotice:!1,noSuggestionNotice:"No results",orientation:"bottom",forceFixPosition:!1};f.element=c,f.el=a(c),f.suggestions=[],f.badQueries=[],f.selectedIndex=-1,f.currentValue=f.element.value,f.intervalId=0,f.cachedResponse={},f.onChangeInterval=null,f.onChange=null,f.isLocal=!1,f.suggestionsContainer=null,f.noSuggestionsContainer=null,f.options=a.extend({},g,d),f.classes={selected:"autocomplete-selected",suggestion:"autocomplete-suggestion"},f.hint=null,f.hintValue="",f.selection=null,f.initialize(),f.setOptions(d)}var c=function(){return{escapeRegExChars:function(a){return a.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},createNode:function(a){var b=document.createElement("div");return b.className=a,b.style.position="absolute",b.style.display="none",b}}}(),d={ESC:27,TAB:9,RETURN:13,LEFT:37,UP:38,RIGHT:39,DOWN:40};b.utils=c,a.Autocomplete=b,b.formatResult=function(a,b){var d=a.value.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;"),e="("+c.escapeRegExChars(b)+")";return d.replace(new RegExp(e,"gi"),"<strong>$1</strong>")},b.prototype={killerFn:null,initialize:function(){var c,d=this,e="."+d.classes.suggestion,f=d.classes.selected,g=d.options;d.element.setAttribute("autocomplete","off"),d.killerFn=function(b){0===a(b.target).closest("."+d.options.containerClass).length&&(d.killSuggestions(),d.disableKillerFn())},d.noSuggestionsContainer=a('<div class="autocomplete-no-suggestion"></div>').html(this.options.noSuggestionNotice).get(0),d.suggestionsContainer=b.utils.createNode(g.containerClass),c=a(d.suggestionsContainer),c.appendTo(g.appendTo),"auto"!==g.width&&c.width(g.width),c.on("mouseover.autocomplete",e,function(){d.activate(a(this).data("index"))}),c.on("mouseout.autocomplete",function(){d.selectedIndex=-1,c.children("."+f).removeClass(f)}),c.on("click.autocomplete",e,function(){d.select(a(this).data("index"))}),d.fixPositionCapture=function(){d.visible&&d.fixPosition()},a(window).on("resize.autocomplete",d.fixPositionCapture),d.el.on("keydown.autocomplete",function(a){d.onKeyPress(a)}),d.el.on("keyup.autocomplete",function(a){d.onKeyUp(a)}),d.el.on("blur.autocomplete",function(){d.onBlur()}),d.el.on("focus.autocomplete",function(){d.onFocus()}),d.el.on("change.autocomplete",function(a){d.onKeyUp(a)}),d.el.on("input.autocomplete",function(a){d.onKeyUp(a)})},onFocus:function(){var a=this;a.fixPosition(),a.options.minChars<=a.el.val().length&&a.onValueChange()},onBlur:function(){this.enableKillerFn()},setOptions:function(b){var c=this,d=c.options;a.extend(d,b),c.isLocal=a.isArray(d.lookup),c.isLocal&&(d.lookup=c.verifySuggestionsFormat(d.lookup)),d.orientation=c.validateOrientation(d.orientation,"bottom"),a(c.suggestionsContainer).css({"max-height":d.maxHeight+"px",width:d.width+"px","z-index":d.zIndex})},clearCache:function(){this.cachedResponse={},this.badQueries=[]},clear:function(){this.clearCache(),this.currentValue="",this.suggestions=[]},disable:function(){var a=this;a.disabled=!0,clearInterval(a.onChangeInterval),a.currentRequest&&a.currentRequest.abort()},enable:function(){this.disabled=!1},fixPosition:function(){var b=this,c=a(b.suggestionsContainer),d=c.parent().get(0);if(d===document.body||b.options.forceFixPosition){var e=b.options.orientation,f=c.outerHeight(),g=b.el.outerHeight(),h=b.el.offset(),i={top:h.top,left:h.left};if("auto"===e){var j=a(window).height(),k=a(window).scrollTop(),l=-k+h.top-f,m=k+j-(h.top+g+f);e=Math.max(l,m)===l?"top":"bottom"}if(i.top+="top"===e?-f:g,d!==document.body){var n,o=c.css("opacity");b.visible||c.css("opacity",0).show(),n=c.offsetParent().offset(),i.top-=n.top,i.left-=n.left,b.visible||c.css("opacity",o).hide()}"auto"===b.options.width&&(i.width=b.el.outerWidth()-2+"px"),c.css(i)}},enableKillerFn:function(){var b=this;a(document).on("click.autocomplete",b.killerFn)},disableKillerFn:function(){var b=this;a(document).off("click.autocomplete",b.killerFn)},killSuggestions:function(){var a=this;a.stopKillSuggestions(),a.intervalId=window.setInterval(function(){a.hide(),a.stopKillSuggestions()},50)},stopKillSuggestions:function(){window.clearInterval(this.intervalId)},isCursorAtEnd:function(){var a,b=this,c=b.el.val().length,d=b.element.selectionStart;return"number"==typeof d?d===c:document.selection?(a=document.selection.createRange(),a.moveStart("character",-c),c===a.text.length):!0},onKeyPress:function(a){var b=this;if(!b.disabled&&!b.visible&&a.which===d.DOWN&&b.currentValue)return void b.suggest();if(!b.disabled&&b.visible){switch(a.which){case d.ESC:b.el.val(b.currentValue),b.hide();break;case d.RIGHT:if(b.hint&&b.options.onHint&&b.isCursorAtEnd()){b.selectHint();break}return;case d.TAB:if(b.hint&&b.options.onHint)return void b.selectHint();if(-1===b.selectedIndex)return void b.hide();if(b.select(b.selectedIndex),b.options.tabDisabled===!1)return;break;case d.RETURN:if(-1===b.selectedIndex)return void b.hide();b.select(b.selectedIndex);break;case d.UP:b.moveUp();break;case d.DOWN:b.moveDown();break;default:return}a.stopImmediatePropagation(),a.preventDefault()}},onKeyUp:function(a){var b=this;if(!b.disabled){switch(a.which){case d.UP:case d.DOWN:return}clearInterval(b.onChangeInterval),b.currentValue!==b.el.val()&&(b.findBestHint(),b.options.deferRequestBy>0?b.onChangeInterval=setInterval(function(){b.onValueChange()},b.options.deferRequestBy):b.onValueChange())}},onValueChange:function(){var b,c=this,d=c.options,e=c.el.val(),f=c.getQuery(e);return c.selection&&c.currentValue!==f&&(c.selection=null,(d.onInvalidateSelection||a.noop).call(c.element)),clearInterval(c.onChangeInterval),c.currentValue=e,c.selectedIndex=-1,d.triggerSelectOnValidInput&&(b=c.findSuggestionIndex(f),-1!==b)?void c.select(b):void(f.length<d.minChars?c.hide():c.getSuggestions(f))},findSuggestionIndex:function(b){var c=this,d=-1,e=b.toLowerCase();return a.each(c.suggestions,function(a,b){return b.value.toLowerCase()===e?(d=a,!1):void 0}),d},getQuery:function(b){var c,d=this.options.delimiter;return d?(c=b.split(d),a.trim(c[c.length-1])):b},getSuggestionsLocal:function(b){var c,d=this,e=d.options,f=b.toLowerCase(),g=e.lookupFilter,h=parseInt(e.lookupLimit,10);return c={suggestions:a.grep(e.lookup,function(a){return g(a,b,f)})},h&&c.suggestions.length>h&&(c.suggestions=c.suggestions.slice(0,h)),c},getSuggestions:function(b){var c,d,e,f,g=this,h=g.options,i=h.serviceUrl;if(h.params[h.paramName]=b,d=h.ignoreParams?null:h.params,h.onSearchStart.call(g.element,h.params)!==!1){if(a.isFunction(h.lookup))return void h.lookup(b,function(a){g.suggestions=a.suggestions,g.suggest(),h.onSearchComplete.call(g.element,b,a.suggestions)});g.isLocal?c=g.getSuggestionsLocal(b):(a.isFunction(i)&&(i=i.call(g.element,b)),e=i+"?"+a.param(d||{}),c=g.cachedResponse[e]),c&&a.isArray(c.suggestions)?(g.suggestions=c.suggestions,g.suggest(),h.onSearchComplete.call(g.element,b,c.suggestions)):g.isBadQuery(b)?h.onSearchComplete.call(g.element,b,[]):(g.currentRequest&&g.currentRequest.abort(),f={url:i,data:d,type:h.type,dataType:h.dataType},a.extend(f,h.ajaxSettings),g.currentRequest=a.ajax(f).done(function(a){var c;g.currentRequest=null,c=h.transformResult(a),g.processResponse(c,b,e),h.onSearchComplete.call(g.element,b,c.suggestions)}).fail(function(a,c,d){h.onSearchError.call(g.element,b,a,c,d)}))}},isBadQuery:function(a){if(!this.options.preventBadQueries)return!1;for(var b=this.badQueries,c=b.length;c--;)if(0===a.indexOf(b[c]))return!0;return!1},hide:function(){var b=this,c=a(b.suggestionsContainer);a.isFunction(b.options.onHide)&&b.visible&&b.options.onHide.call(b.element,c),b.visible=!1,b.selectedIndex=-1,clearInterval(b.onChangeInterval),a(b.suggestionsContainer).hide(),b.signalHint(null)},suggest:function(){if(0===this.suggestions.length)return void(this.options.showNoSuggestionNotice?this.noSuggestions():this.hide());var b,c,d=this,e=d.options,f=e.groupBy,g=e.formatResult,h=d.getQuery(d.currentValue),i=d.classes.suggestion,j=d.classes.selected,k=a(d.suggestionsContainer),l=a(d.noSuggestionsContainer),m=e.beforeRender,n="",o=function(a){var c=a.data[f];return b===c?"":(b=c,'<div class="autocomplete-group"><strong>'+b+"</strong></div>")};return e.triggerSelectOnValidInput&&(c=d.findSuggestionIndex(h),-1!==c)?void d.select(c):(a.each(d.suggestions,function(a,b){f&&(n+=o(b,h,a)),n+='<div class="'+i+'" data-index="'+a+'">'+g(b,h)+"</div>"}),this.adjustContainerWidth(),l.detach(),k.html(n),a.isFunction(m)&&m.call(d.element,k),d.fixPosition(),k.show(),e.autoSelectFirst&&(d.selectedIndex=0,k.scrollTop(0),k.children("."+i).first().addClass(j)),d.visible=!0,void d.findBestHint())},noSuggestions:function(){var b=this,c=a(b.suggestionsContainer),d=a(b.noSuggestionsContainer);this.adjustContainerWidth(),d.detach(),c.empty(),c.append(d),b.fixPosition(),c.show(),b.visible=!0},adjustContainerWidth:function(){var b,c=this,d=c.options,e=a(c.suggestionsContainer);"auto"===d.width&&(b=c.el.outerWidth()-2,e.width(b>0?b:300))},findBestHint:function(){var b=this,c=b.el.val().toLowerCase(),d=null;c&&(a.each(b.suggestions,function(a,b){var e=0===b.value.toLowerCase().indexOf(c);return e&&(d=b),!e}),b.signalHint(d))},signalHint:function(b){var c="",d=this;b&&(c=d.currentValue+b.value.substr(d.currentValue.length)),d.hintValue!==c&&(d.hintValue=c,d.hint=b,(this.options.onHint||a.noop)(c))},verifySuggestionsFormat:function(b){return b.length&&"string"==typeof b[0]?a.map(b,function(a){return{value:a,data:null}}):b},validateOrientation:function(b,c){return b=a.trim(b||"").toLowerCase(),-1===a.inArray(b,["auto","bottom","top"])&&(b=c),b},processResponse:function(a,b,c){var d=this,e=d.options;a.suggestions=d.verifySuggestionsFormat(a.suggestions),e.noCache||(d.cachedResponse[c]=a,e.preventBadQueries&&0===a.suggestions.length&&d.badQueries.push(b)),b===d.getQuery(d.currentValue)&&(d.suggestions=a.suggestions,d.suggest())},activate:function(b){var c,d=this,e=d.classes.selected,f=a(d.suggestionsContainer),g=f.find("."+d.classes.suggestion);return f.find("."+e).removeClass(e),d.selectedIndex=b,-1!==d.selectedIndex&&g.length>d.selectedIndex?(c=g.get(d.selectedIndex),a(c).addClass(e),c):null},selectHint:function(){var b=this,c=a.inArray(b.hint,b.suggestions);b.select(c)},select:function(a){var b=this;b.hide(),b.onSelect(a)},moveUp:function(){var b=this;if(-1!==b.selectedIndex)return 0===b.selectedIndex?(a(b.suggestionsContainer).children().first().removeClass(b.classes.selected),b.selectedIndex=-1,b.el.val(b.currentValue),void b.findBestHint()):void b.adjustScroll(b.selectedIndex-1)},moveDown:function(){var a=this;a.selectedIndex!==a.suggestions.length-1&&a.adjustScroll(a.selectedIndex+1)},adjustScroll:function(b){var c=this,d=c.activate(b);if(d){var e,f,g,h=a(d).outerHeight();e=d.offsetTop,f=a(c.suggestionsContainer).scrollTop(),g=f+c.options.maxHeight-h,f>e?a(c.suggestionsContainer).scrollTop(e):e>g&&a(c.suggestionsContainer).scrollTop(e-c.options.maxHeight+h),c.options.preserveInput||c.el.val(c.getValue(c.suggestions[b].value)),c.signalHint(null)}},onSelect:function(b){var c=this,d=c.options.onSelect,e=c.suggestions[b];c.currentValue=c.getValue(e.value),c.currentValue===c.el.val()||c.options.preserveInput||c.el.val(c.currentValue),c.signalHint(null),c.suggestions=[],c.selection=e,a.isFunction(d)&&d.call(c.element,e)},getValue:function(a){var b,c,d=this,e=d.options.delimiter;return e?(b=d.currentValue,c=b.split(e),1===c.length?a:b.substr(0,b.length-c[c.length-1].length)+a):a},dispose:function(){var b=this;b.el.off(".autocomplete").removeData("autocomplete"),b.disableKillerFn(),a(window).off("resize.autocomplete",b.fixPositionCapture),a(b.suggestionsContainer).remove()}},a.fn.autocomplete=a.fn.devbridgeAutocomplete=function(c,d){var e="autocomplete";return 0===arguments.length?this.first().data(e):this.each(function(){var f=a(this),g=f.data(e);"string"==typeof c?g&&"function"==typeof g[c]&&g[c](d):(g&&g.dispose&&g.dispose(),g=new b(this,c),f.data(e,g))})}});;
//facebook
(function(d, s, id) {
var js, fjs = d.getElementsByTagName(s)[0];
if (d.getElementById(id)) return;
js = d.createElement(s); js.id = id;
js.src = "//connect.facebook.net/it_IT/sdk.js#xfbml=1&appId=455565641219872&version=v2.0";
fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));
//google+1
(function() {
var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
po.src = 'https://apis.google.com/js/plusone.js';
var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
})();
//twitter
!function(d,s,id){
var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}
}(document, 'script', 'twitter-wjs');;
function filesizeHuman(a,b){if(0===a)return a;b=b||1;var c=["Bytes","KB","MB","GB","TB"],d=parseInt(Math.floor(Math.log(a)/Math.log(1024)));return(a/Math.pow(1024,d)).toFixed(b)+" "+c[d]}function nodes2Bytes(a){return filesizeHuman(400+56*a)}function getPosition(a){for(var b=0,c=0;a;)b+=a.offsetLeft-a.scrollLeft+a.clientLeft,c+=a.offsetTop-a.scrollTop+a.clientTop,a=a.offsetParent;return{x:b,y:c}}function hideAll(){$(".popup").each(function(){$(this).hide()})}function chooseDownloadFormat(a){hideAll();var b=getPosition(a.currentTarget);$("#download-formats").css("top",b.y-4),$("#download-formats").show()}function chooseViewFormat(a){hideAll();var b=getPosition(a.currentTarget);$("#view-formats").css("top",b.y-4),$("#view-formats").show(),$("#download-formats").hide()}function GeoJSONFormat(){this.param={key:"geojson",syntax:"json",name:"GeoJSON",extension:"geojson",contenttype:"appplication/json"},this.exportData=function(a){return JSON.stringify(a)},this.display=function(a){return prettyData.json(a)}}function GPXFormat(){this.param={key:"gpx",syntax:"xml",name:"GPX",extension:"gpx",contenttype:"application/gpx+xml"},this.exportData=function(a){return togpx(a)},this.display=function(a){return prettyData.xml(a)}}function KMLFormat(){this.param={key:"kml",syntax:"xml",name:"KML",extension:"kml",contenttype:"application/vnd.google-earth.kml+xml"},this.exportData=function(a){return tokml(a)},this.display=function(a){return prettyData.xml(a)}}function MediawikiFormat(){this.param={key:"mediawiki",syntax:"nohighlight",name:"Mediawiki",extension:"txt",contenttype:"text/plain"},this.exportData=function(a){return geojsonToPath(a)}}$("#export-close").on("click",function(){$("#export-format").hide()});var Format=function(){this.param={key:"format",name:"RootFormat"}};Format.prototype={loadAll:function(a){a.forEach(function(a){f=new window[a],f.load()})},load:function(){var a=document.createElement("a"),b=document.createTextNode("View in "+this.param.name);a.appendChild(b),a.title="View the simplified data in "+this.param.name,a.className="view",$(a).on("click",this.viewClick.bind(this)),$("#view-formats").append(a),a=document.createElement("a"),b=document.createTextNode("Download in "+this.param.name),a.appendChild(b),a.title="Download the simplified data in "+this.param.name,a.className="download",$(a).on("click",this.saveClick.bind(this)),$("#download-formats").append(a)},display:function(a){return a},save:function(a){name=a.name.replace(/\..*/,""),name=name+"_"+a.simplifiedLayerNodes+"nodes."+this.param.extension;try{if(new Blob){var b=this.exportData(a.simplifiedLayerData),c=new Blob([b],{type:this.param.contenttype+";charset=utf-8"});saveAs(c,name)}}catch(d){alert("Please upload GPX/GeoJSON/KML file first, using Chrome or Firefox: "+d.message),console.log(d.message)}hideAll()},saveClick:function(){this.save(window.currentLayer)},view:function(a){try{if(new Blob){var b=this.exportData(a.simplifiedLayerData);b=this.display(b),$("code").attr("class",this.param.syntax),$("#export-content").text(b),a.simplifiedLayerNodes<1e3&&$("code").each(function(a,b){hljs.highlightBlock(b)}),$("#export-format h5").html("Simplified geometry in "+this.param.name+" format"),$("#export-format").show()}}catch(c){alert("Please upload GPX/GeoJSON/KML file first, using Chrome or Firefox: "+c.message),console.log(c.message)}hideAll()},viewClick:function(){this.view(window.currentLayer)}},GeoJSONFormat.prototype=new Format,GPXFormat.prototype=new Format,KMLFormat.prototype=new Format,MediawikiFormat.prototype=new Format;;
function updateLayers(){$(".leaflet-control-switcher").html("");for(var a in window.Layers){var b=window.Layers[a];$(".leaflet-control-switcher").append('<option value="'+b.id+'" '+(window.currentLayer.name==b.name?' selected="selected"':"")+">"+b.name+"</option>")}Object.keys(window.Layers).length>0?$(".leaflet-control-switcher-box").show():$(".leaflet-control-switcher-box").hide()}function clearMap(){for(var a in window.Layers)window.Layers[a].remove();window.Layers={},updateLayers()}window.style1={color:"red",opacity:.7,fillOpacity:.7,weight:5,clickable:!1},window.style2={color:"blue",opacity:1,fillOpacity:1,weight:2,clickable:!1};var LayerOptimizer=function(a){this.id=this.createId(),this.name=a.filename,this.sourceLayer=a.layer,this.sourceLayerStyle=window.style1,this.sourceLayerData=this.getSourceData(),this.sourceLayerNodes=this.sourceLayerData.geometry.coordinates.length,this.simplifiedLayerStyle=window.style2,this.simplifiedLayer=L.geoJson(null,{style:this.simplifiedLayerStyle}).addTo(window.map),this.simplifiedLayerNodes=0,this.controller=null};LayerOptimizer.prototype={getSourceData:function(){return this.sourceLayer.getLayers()[0].toGeoJSON()},choose:function(){this.zoom(),this.createLayerGroup(),this.displayInfos()},optimize:function(a){this.simplifiedLayer.clearLayers(),this.simplifiedLayerData=this.getSourceData(),this.simplifiedLayerData.geometry.coordinates=simplifyGeometry(this.simplifiedLayerData.geometry.coordinates,a),this.simplifiedLayer.addData(this.simplifiedLayerData),this.simplifiedLayerNodes=this.simplifiedLayerData.geometry.coordinates.length},getBounds:function(){return this.sourceLayer.getBounds()},zoom:function(){window.map.fitBounds(this.getBounds())},createLayerGroup:function(){var a={};a[this.name+" (simplified)"]=this.simplifiedLayer,a[this.name+" (source)"]=this.sourceLayer,this.controller=L.control.layers(null,a),this.controller.addTo(window.map)},displayInfos:function(){var a="Optimize : "+this.name,b="From "+this.sourceLayerNodes+" nodes to "+this.simplifiedLayerNodes+" nodes";$("#filename").html(a),$("#nodes").html(b)},remove:function(){this.removeLayers(),this.removeController()},removeLayers:function(){try{window.map.removeLayer(this.simplifiedLayer),window.map.removeLayer(this.sourceLayer)}catch(a){console.log("Layers not found, probably already removed")}},removeController:function(){try{void 0!==this.controller._map&&this.controller.removeFrom(window.map)}catch(a){console.log("Controller not found, probably already removed")}},createId:function(){function a(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return a()+a()+a()+a()}};;
$(function(){var a=new L.Map("map",{attributionControl:!1}).setView(L.latLng(36,-30),3);window.map=a,L.tileLayer("http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png").addTo(a),window.Layers={},window.currentLayer=null,L.Control.FileLayerLoad.LABEL='<i class="fa fa-folder-open"></i>';var b=L.Control.fileLayerLoad({addToMap:!0,fitBounds:!1,fileSizeLimit:8096,layerOptions:{style:style1,pointToLayer:function(a,b){return L.circle(b,10,{style:style1})}}}).addTo(a);b.loader.on("data:loaded",function(a){window.currentLayer&&window.currentLayer.removeController();var b=new LayerOptimizer(a);b.optimize(0),b.choose(),window.Layers[b.id]=b,window.currentLayer=b,updateLayers()}).on("data:error",function(a){console.log("ERROR",a)}),function(){var a=new L.Control({position:"topleft"});return a.onAdd=function(){var a=L.DomUtil.create("div","leaflet-control-download leaflet-bar"),b=L.DomUtil.create("a","",a);return b.href="#",b.target="_blank",b.title="Download simplified file",b.innerHTML='<i class="fa fa-download"></i>',L.DomEvent.on(b,"click",L.DomEvent.stop).on(b,"click",chooseDownloadFormat),a},a}().addTo(a),function(){var a=new L.Control({position:"topleft"});return a.onAdd=function(){var a=L.DomUtil.create("div","leaflet-control-view leaflet-bar"),b=L.DomUtil.create("a","",a);return b.href="#",b.target="_blank",b.title="View simplified file",b.innerHTML='<i class="fa fa-eye"></i>',L.DomEvent.on(b,"click",L.DomEvent.stop).on(b,"click",chooseViewFormat),a},a}().addTo(a),function(){var a=new L.Control({position:"topleft"});return a.onAdd=function(){var a=L.DomUtil.create("div","leaflet-control-erase leaflet-bar"),b=L.DomUtil.create("a","",a);return b.href="#",b.target="_blank",b.title="Clear the map",b.innerHTML='<i class="fa fa-eraser"></i>',L.DomEvent.on(b,"click",L.DomEvent.stop).on(b,"click",clearMap),a},a}().addTo(a),function(){var a=new L.Control({position:"bottomleft"});return a.onAdd=function(){var a=L.DomUtil.create("div","leaflet-control-stats");return a.id="stats",a.innerHTML='<span id="nodes"></span><br /><span id="filename"></span>',filename$=$("#filename",a),nodes$=$("#nodes",a),a},a}().addTo(a),L.control.sidebar("sidebar",{position:"right",autoPan:!1}).addTo(a).show(),L.control.attribution({position:"topright",prefix:'<a href="http://leafletjs.com/">Leaflet</a> &bull; <a href="http://osm.org/" target="_blank">OpenStreetMap contributors</a>'}).addTo(a),function(){var a=new L.Control({position:"topright"});return a.onAdd=function(){var a=L.DomUtil.create("div","leaflet-control-switcher-box leaflet-bar"),b=L.DomUtil.create("label","",a);b.href="#",b.title="Choose the active layer",b.innerHTML="Layer switcher";var c=L.DomUtil.create("select","leaflet-control-switcher leaflet-bar",a);return L.DomEvent.on(c,"change",function(){window.currentLayer.removeController(),window.currentLayer=window.Layers[$(this).val()],window.currentLayer.choose()}),a},a}().addTo(a),$("#slider").slider({value:0,min:0,max:.1,step:5e-5,precision:8,tooltip:"hide"}).on("slide",function(a){window.currentLayer.optimize(a.value),window.currentLayer.displayInfos()}).parent().width("100%"),$("#helpbtn").on("click",function(){$("#modal").modal("show")});var c=$.cookie("tour");(!c||parseInt(c)<3)&&($("#modal").modal("show"),c=(parseInt(c)||0)+1,$.cookie("tour",c,{expires:120}));var d=new Format;d.loadAll(["GeoJSONFormat","GPXFormat","KMLFormat","MediawikiFormat"]),hljs.initHighlightingOnLoad()});