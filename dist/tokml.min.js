!function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;b="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,b.tokml=a()}}(function(){return function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){function d(a){return function(b){var c="",d="";if(a.simplestyle&&q(b.properties)&&(c=n(b.properties),d=u("styleUrl","#"+r(b.properties))),!b.properties||!w.valid(b.geometry))return"";var e=w.any(b.geometry);return e?c+u("Placemark",h(b.properties,a)+i(b.properties,a)+l(b.properties)+j(b.properties,a)+e+d):""}}function e(a,b){if(!a.type)return"";switch(a.type){case"FeatureCollection":return a.features?a.features.map(d(b)).join(""):"";case"Feature":return d(b)(a);default:return d(b)({type:"Feature",geometry:a,properties:{}})}}function f(a){return void 0!==a.documentName?u("name",a.documentName):""}function g(a){return void 0!==a.documentDescription?u("description",a.documentDescription):""}function h(a,b){return a[b.name]?u("name",v(a[b.name])):""}function i(a,b){return a[b.description]?u("description",v(a[b.description])):""}function j(a,b){return a[b.timestamp]?u("TimeStamp",u("when",v(a[b.timestamp]))):""}function k(a){return a.map(function(a){return a.join(",")}).join(" ")}function l(a){return u("ExtendedData",s(a).map(m).join(""))}function m(a){return u("Data",u("value",v(a[1])),[["name",v(a[0])]])}function n(a){return u("Style",u("IconStyle",u("Icon",u("href",o(a))))+p(a),[["id",r(a)]])}function o(a){var b=a["marker-size"]||"medium",c=a["marker-symbol"]?"-"+a["marker-symbol"]:"",d=(a["marker-color"]||"7e7e7e").replace("#","");return"https://api.tiles.mapbox.com/v3/marker/pin-"+b.charAt(0)+c+"+"+d+".png"}function p(a){return u("hotSpot","",[["xunits","fraction"],["yunits","fraction"],["x",.5],["y",.5]])}function q(a){return!!(a["marker-size"]||a["marker-symbol"]||a["marker-color"])}function r(a){return(a["marker-symbol"]||"")+(a["marker-color"]||"").replace("#","")+(a["marker-size"]||"")}function s(a){var b=[];for(var c in a)b.push([c,a[c]]);return b}var t=a("strxml"),u=t.tag,v=t.encode;b.exports=function(a,b){return b=b||{documentName:void 0,documentDescription:void 0,name:"name",description:"description",simplestyle:!1,timestamp:"timestamp"},'<?xml version="1.0" encoding="UTF-8"?>'+u("kml",u("Document",f(b)+g(b)+e(a,b)),[["xmlns","http://www.opengis.net/kml/2.2"]])};var w={Point:function(a){return u("Point",u("coordinates",a.coordinates.join(",")))},LineString:function(a){return u("LineString",u("coordinates",k(a.coordinates)))},Polygon:function(a){if(!a.coordinates.length)return"";var b=a.coordinates[0],c=a.coordinates.slice(1),d=u("outerBoundaryIs",u("LinearRing",u("coordinates",k(b)))),e=c.map(function(a){return u("innerBoundaryIs",u("LinearRing",u("coordinates",k(a))))}).join("");return u("Polygon",d+e)},MultiPoint:function(a){return a.coordinates.length?u("MultiGeometry",a.coordinates.map(function(a){return w.Point({coordinates:a})}).join("")):""},MultiPolygon:function(a){return a.coordinates.length?u("MultiGeometry",a.coordinates.map(function(a){return w.Polygon({coordinates:a})}).join("")):""},MultiLineString:function(a){return a.coordinates.length?u("MultiGeometry",a.coordinates.map(function(a){return w.LineString({coordinates:a})}).join("")):""},GeometryCollection:function(a){return u("MultiGeometry",a.geometries.map(w.any).join(""))},valid:function(a){return a&&a.type&&(a.coordinates||"GeometryCollection"===a.type&&a.geometries.every(w.valid))},any:function(a){return w[a.type]?w[a.type](a):""}}},{strxml:2}],2:[function(a,b,c){function d(a){return a&&a.length?" "+a.map(function(a){return a[0]+'="'+a[1]+'"'}).join(" "):""}function e(a,b){return"<"+a+d(b)+"/>"}function f(a,b,c){return"<"+a+d(c)+">"+b+"</"+a+">"}function g(a){return(null===a?"":a.toString()).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}b.exports.attr=d,b.exports.tagClose=e,b.exports.tag=f,b.exports.encode=g},{}]},{},[1])(1)});